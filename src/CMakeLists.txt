set(CMAKE_C_FLAGS "-fno-stack-protector -O2 -g -fPIC -Wall")
set(CMAKE_CXX_FLAGS "-fno-stack-protector -O2 -g -fPIC -Wall")

include_directories(jitter)
include_directories(cache)
include_directories(loader/loader32)
include_directories(loader/loader64)
include_directories(runtime)
include_directories(target)
include_directories(target/arm)
include_directories(target/arm64)
include_directories(syscall)
include_directories(syscall/syscall32_64)
include_directories(syscall/syscall64_64)
include_directories(gdb)
include_directories(.)

add_subdirectory(jitter)
add_subdirectory(cache)
add_subdirectory(loader)
add_subdirectory(runtime)
add_subdirectory(target)
add_subdirectory(syscall)
add_subdirectory (gdb)

add_executable(umeq-arm main.c start.S)
target_link_libraries(umeq-arm -nostdlib -T${umeq_SOURCE_DIR}/src/custom.ld -Wl,-z,execstack -static -Wl,--start-group jitter loader32 cache runtime arm_target syscall32_64 gdb -Wl,--end-group)

add_executable(umeq-arm64 main.c start.S)
target_link_libraries(umeq-arm64 -nostdlib -T${umeq_SOURCE_DIR}/src/custom.ld -Wl,-z,execstack -static -Wl,--start-group jitter loader64 cache runtime arm64_target syscall64_64 gdb -Wl,--end-group)
